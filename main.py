import streamlit as st
import numpy as np
import matplotlib.pyplot as plt

st.set_page_config(page_title="ê³ ë“±í•™ìƒìš© íˆ¬ì‚¬ì²´ ìš´ë™ ì‹œë®¬ë ˆì´í„°")

st.title("ğŸ¯ ê³ ë“±í•™ìƒ ìˆ˜ì¤€ íˆ¬ì‚¬ì²´ ìš´ë™ (ê³µê¸°ì €í•­ í¬í•¨) ì‹œë®¬ë ˆì´í„°")

st.write("""
ì´ ì‹œë®¬ë ˆì´í„°ëŠ” **ì„ í˜• í•­ë ¥(ê³µê¸°ì €í•­)**ì„ ì´ìš©í•œ íˆ¬ì‚¬ì²´ ìš´ë™ì„ ê³„ì‚°í•©ë‹ˆë‹¤.
- í•­ë ¥ì€ ì†ë„ì— ë¹„ë¡€í•œë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤.
- ê³ ë“±í•™ìƒ ìˆ˜ì¤€ì—ì„œ ê°€ëŠ¥í•œ ê°€ì¥ ë‹¨ìˆœí•œ ê³µê¸°ì €í•­ ëª¨ë¸ì…ë‹ˆë‹¤.
""")

# -------------------------
# ì…ë ¥ê°’ UI
# -------------------------
speed = st.slider("ì´ˆê¸° ì†ë„ (m/s)", 1.0, 100.0, 40.0)
angle = st.slider("ë°œì‚¬ ê°ë„ (ë„)", 1.0, 89.0, 45.0)
k = st.slider("í•­ë ¥ ê³„ìˆ˜ k", 0.0, 1.0, 0.1)
dt = 0.01  # ì‹œê°„ ê°„ê²©
g = 9.8

# ì´ˆê¸°ê°’ ì„¤ì •
angle_rad = np.radians(angle)
vx = speed * np.cos(angle_rad)
vy = speed * np.sin(angle_rad)
x, y = 0, 0

# ê²°ê³¼ ì €ì¥ ë¦¬ìŠ¤íŠ¸
xs, ys = [x], [y]

# -------------------------
# ì‹œë®¬ë ˆì´ì…˜
# -------------------------
while y >= 0:
    # ê°€ì†ë„
    ax = -k * vx
    ay = -g - k * vy

    # ì†ë„ ì—…ë°ì´íŠ¸
    vx += ax * dt
    vy += ay * dt

    # ìœ„ì¹˜ ì—…ë°ì´íŠ¸
    x += vx * dt
    y += vy * dt

    xs.append(x)
    ys.append(y)

    if x > 1000:  # ì•ˆì „ì¥ì¹˜
        break

# ì‚¬ê±°ë¦¬/ìµœëŒ€ê³ ë„ ê³„ì‚°
max_height = max(ys)
range_m = xs[-2]  # ì§€ë©´ ë„ë‹¬ ì§ì „ ìœ„ì¹˜
flight_time = len(xs) * dt

# -------------------------
# ê²°ê³¼ ì¶œë ¥
# -------------------------
st.subheader("ğŸ“Œ ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼")
st.write(f"**ë¹„í–‰ ì‹œê°„:** {flight_time:.2f} ì´ˆ")
st.write(f"**ìµœëŒ€ ê³ ë„:** {max_height:.2f} m")
st.write(f"**ì‚¬ê±°ë¦¬:** {range_m:.2f} m")

# -------------------------
# ê¶¤ì  ê·¸ë˜í”„
# -------------------------
fig, ax = plt.subplots(figsize=(7,4))
ax.plot(xs, ys, label="íˆ¬ì‚¬ì²´ ê¶¤ì ")
ax.set_xlabel("x (m)")
ax.set_ylabel("y (m)")
ax.set_title("íˆ¬ì‚¬ì²´ ìš´ë™ ê¶¤ì  (ê³µê¸°ì €í•­ í¬í•¨)")
ax.grid(True)
st.pyplot(fig)

st.write("---")
st.write("Tip: í•­ë ¥ ê³„ìˆ˜ k ê°’ì„ 0ìœ¼ë¡œ í•˜ë©´ **ì´ìƒì  í¬ë¬¼ì„  ìš´ë™(ê³µê¸°ì €í•­ ì—†ìŒ)**ì´ ë‚˜ì˜µë‹ˆë‹¤!")
